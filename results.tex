\section{Detailed Results on Real-world Apps}\label{Se:completeRes}

In \secref{practical}, we describe an experiment designed to evaluate our Bayesian analysis in ``pure'' form, i.e. without the support of information-flow tracking to detect relevant values. To make our description of this experiment complete, we include \tableref{realworldAll}, which provides a detailed summary of the results of this experiment across all benchmarks (including ones on which no leakages were detected).
%
For comparability between the H-BD and T-BD configurations, we count different dynamic reports involving the same pair of source/sink APIs as a single leakage instance.

\begin{table*}
\begin{small}
\begin{center}
	\begin{tabular}{l|c|c|c|c}
	\multicolumn{1}{c|}{App} & Domain & Deep crawl? & H-BD & T-BD \\
	\hline
	{\tt air.au.com.metro.DumbWaysToDie}			& games/casual 		& 		      		& 0 (C) & 0 (C) \\
	{\tt at.nerbrothers.SuperJump}					& games/arcade 		& 		      		& 1 & 0 (C) \\
	{\tt atsoft.games.smgame}						& games/arcade 		& \checkmark 	& 6 & 6  \\
	{\tt com.antivirus}							& communication 			& \checkmark 	& 1 & 1 \\
	{\tt com.appershopper.ios7lockscreen}			& personalization 		&		      		& 8 (1 FP) & 7 \\
	{\tt com.applicaster.il.hotvod}					& entertainment 		& \checkmark 	& 2 & 2 \\
	{\tt com.appstar.callrecorder}					& tools 					& 		      		& 0        & 0    \\
	{\tt com.awesomecargames.mountainclimbrace\_1}						
											& games/racing					& 		      		& 0 (C) & 0 (C) \\
	{\tt com.bestcoolfungames.antsmasher}	& games/arcade 			& \checkmark 	& 2 & 2 \\
	{\tt com.bigduckgames.flow}					& games/puzzles		& 		      		& 2 & 0 (C) \\
	{\tt com.bitfitlabs.fingerprint.lockscreen}			& games/casual 		& 		      		& 4 & 0 \\
	{\tt com.channel2.mobile.ui}					& news 				& \checkmark 	& 2 & 2  \\
	{\tt com.chillingo.parkingmaniafree.android.rowgplay} 		
													&	 games/racing 		& 				& 0 (C) & 0 (C) \\
	{\tt com.cleanmaster.mguard}					&  tools 				&\checkmark	& 2 & 2 \\
	{\tt com.coolfish.cathairsalon}					&  games/casual 		&\checkmark	& 5 & 0 (C) \\
	{\tt com.coolfish.snipershooting}				& games/action 		&\checkmark	& 5 & 0 (C) \\
	{\tt com.cube.gdpc.isr}						& health \& fitness 			& 				& 0 (C) & 0 (C) \\
	{\tt com.cyworld.camera}						& photography  		& 		      		& 1 & 1 \\
	{\tt com.devuni.flashlight} 					& tools 					& \checkmark   		& 2 & 2 \\
	{\tt com.digisoft.TransparentScreen}		& entertainment 			&\checkmark	& 2 & 2 \\
	{\tt com.domobile.applock}					& tools  					&\checkmark	& 0 & 0   \\
	{\tt com.dropbox.android}						& productivity 			&\checkmark	& 1 & 0 (C) \\
	{\tt com.ea.game.fifa14\_row}					& games/sports 		& 		      		& 0 & 0 (C) \\
	{\tt com.ebay.mobile}							& shopping 				& 					& 0 & 0 \\
	{\tt com.facebook.katana} 						& social 				& \checkmark 	& 0 & 0 \\
	{\tt com.facebook.orca} 						& communication 		& 	     			& 0  & 0 \\
	{\tt com.g6677.android.cbaby}					& games/casual 		& 				& 2    & 0 (C) \\
	{\tt com.g6677.android.chospital}				& games/casual 		& 		      		& 2 & 0 (C) \\
    {\tt com.g6677.android.design}					& games/casual 		& 		      		& 2 & 0 (C) \\
	{\tt com.g6677.android.pnailspa}				& games/casual 		& 		      		& 2 & 0 (C) \\
	{\tt com.g6677.android.princesshs} 				& games/casual 		& 		      		& 2 & 0 (C) \\
	{\tt com.gameclassic.towerblock}				& games/puzzles 		&\checkmark	& 0 & 0 (C) \\
	{\tt com.gameloft.android.ANMP.GloftDMHM}		& games/casual 	&		      		& 0  & 0   \\
	{\tt com.game.fruitlegendsaga}					& games/puzzles 		& 		      		& 0 & 0 \\
	{\tt com.gau.go.launcherex}					& personalization 			& 		      		& 0 & 0 \\
	{\tt com.glu.deerhunt2}						& games/arcade 			& 				& 0 (C) & 0 (C) \\
	{\tt com.goldtouch.mako}						& news 				&\checkmark	& 3 & 3 \\
	{\tt com.goldtouch.ynet} 						& news 				& \checkmark 	& 2 & 2 \\
	{\tt com.google.android.apps.docs}				& productivity 			& 		      		& 0 & 0 \\
	{\tt com.google.android.apps.translate}			& tools 					& 		      		& 0 & 0 \\
	{\tt com.google.android.youtube}				& media \& video		& 		      		& 1 & 1 \\
	{\tt com.google.earth}						& travel \& local 			& 				& 0 (C) & 0 (C) \\
	{\tt com.halfbrick.fruitninjafree}					& games/arcade 		& 		      		& 0 & 0 \\
	{\tt com.halfbrick.jetpackjoyride}				& games/arcade 		&\checkmark	& 0 & 0 \\
	{\tt com.icloudzone.AsphaltMoto2}				& games/racing 		& 		      		& 0 & 0 \\
	{\tt com.ideomobile.hapoalim}					& finance 				& 		      		& 0 & 0 \\
	{\tt com.imangi.templerun2} 					& games/arcade 		& 		      		& 0 (C) & 0 (C) \\
	{\tt com.kiloo.subwaysurf} 						& games/arcade 		& 		      		& 0 (C) & 0 (C) \\
	{\tt com.king.candycrushsaga}					& games/arcade 		& 		      		& 1 & 0 (C) \\
	{\tt com.sgiggle.production}					& social 					& 		      		& 0       & 0     \\
	{\tt com.skype.raider} 						& communication 			& 		      		& 2 	& 2 \\
	{\tt com.UBI.A90.WW} 						& games/arcade 			& 		      		& 0        & 0   \\
	{\tt com.viber.voip} 							& communication 			&		      		& 0        & 0    \\
	{\tt com.whatsapp} 							& communication 			&		      		& 0        & 0   \\
	\hline \hline
	{\bf total / apps:}	& & 18 / 54  & 65 / 26 (1 FP)  & 35 / 14
	\end{tabular}
	\end{center}
	\caption{\label{Ta:realworldAll}Detailed summary of the results of the H2 experiment described in \secref{practical}}
\end{small}
\end{table*} 

Analogously to \tableref{realworld}, the first two columns of \tableref{realworldAll} list the applications and their respective domain, and the middle column denotes whether crawling was exhaustive. The last two columns specify the overall number of findings by the H-BD and T-BD variants, respectively. We also indicate whether at any point during the run we experienced runtime errors, crashes or abnormal behaviors using the ``(C)'' label alongside the number of findings.

As \tableref{realworldAll} highlights, the difference in leakage alarms by the H-BD and T-BD variants is dramatic. We have analyzed it, and came to the following explanations:
\begin{compactitem}
\item First, as noted in \secref{practical}, the T-BD variant introduces significantly more instability than the H-BD variant, causing illegal application behaviors in 21 cases (compared to only 8 under H-BD). We have investigated this large gap between the H-BD and T-BD configurations, including by decompiling the subject apps. Our analysis links the vast majority of illegal behaviors to limitations that
TaintDroid casts on loading of third-party libraries. For this reason, certain functionality is not executed, also leading to exceptional app states, which both inhibit certain data leaks.\footnote{
	For a technical explanation, see forum comment by William Enck, the TaintDroid moderator, at \href{https://groups.google.com/forum/\#!topic/android-security-discuss/U1fteEX26bk}{https://groups.google.com/forum/\#!topic/android-security-discuss/U1fteEX26bk}.
} 
\item A secondary reason why H-BD is able to detect more leakages, accounting for {\tt com.bitfitlabs.fingerprint.lockscreen}, is that this benchmark makes use of the {\tt mobileCore} module,\footnote{ 
\href{https://www.mobilecore.com/sdk/}{https://www.mobilecore.com/sdk/}
} which is a highly optimized and obfuscated library. We suspect that data flow breaks within this library, though we could not fully confirm this. 
\end{compactitem}
